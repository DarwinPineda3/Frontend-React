import * as React from 'react';
import Accordion from '@mui/material/Accordion';
import AccordionSummary from '@mui/material/AccordionSummary';
import AccordionDetails from '@mui/material/AccordionDetails';
import Typography from '@mui/material/Typography';
import ArrowDownwardIcon from '@mui/icons-material/ArrowDownward';
import { Box, useTheme } from '@mui/material';
import SignatureTable from './MalwareAnalysisSignatureTable';
// import SecurityLeaksTable from './SecurityLeaksTable';

interface MalwareAnalysisAccordionProps {
  signature_data: any[];
}


const MalwareAnalysisAccordion: React.FC<MalwareAnalysisAccordionProps> = ({ signature_data }) => {

  const theme = useTheme();
  const { high, medium, low, critical } = theme.palette.level;
  
  return (
    <Box>
      {signature_data.map((signature, index) => (
        <Accordion key={index}>
          <AccordionSummary
            expandIcon={<ArrowDownwardIcon />}
            aria-controls={`signature-${index}-content`}
            id={`signature-${index}-header`}
            style={{
              backgroundColor:
               signature.type === 'Danger' ? high :
               signature.type === 'Warning' ? medium :
                      low,
              color: '#fff',
              borderRadius: 5,
              opacity: 0.9,
            }}
          >
            <Typography
            variant="h6"
            >
              {signature.title} - (Events: {signature.table.rows.length})
            </Typography>
          </AccordionSummary>
          <AccordionDetails>
            <SignatureTable signature={signature} />
          </AccordionDetails>
        </Accordion>
      ))}
    </Box>
  );
};

export default MalwareAnalysisAccordion;
